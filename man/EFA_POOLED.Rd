% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/EFA_POOLED.R
\name{EFA_POOLED}
\alias{EFA_POOLED}
\title{Exploratory factor analysis on multiple data imputations}
\source{
Rubin, D.B. (1976). Inference and Missing Data. Biometrika 63 (3):
  581â€“90.

van Buuren, S. (2018). Flexible Imputation of Missing Data. Second
  Edition. CRC Press. \url{https://stefvanbuuren.name/fimd/}
}
\usage{
EFA_POOLED(data_list, p = 0.05, ...)
}
\arguments{
\item{data_list}{A list of length \eqn{m}, where \eqn{m} is the number of
imputations. Each list element \eqn{k} is a data frame or matrix of raw data
or a matrix with correlations for data imputation \eqn{k}. See argument
\code{x} in \code{\link{EFA}}.}

\item{p}{Numeric. One minus the confidence level of the CIs. Defaults to 0.05
for 95\% CIs.}

\item{...}{Additional arguments passed to \code{\link{EFA}}.}
}
\value{
A list of class EFA containing (a subset of) the following:

\item{h2}{Final communality estimates from the unrotated solution. This is
based on the squared pooled unrotated loadings, \code{unrot_loadings}.}
\item{unrot_loadings}{Loading matrix containing the final, pooled unrotated
loadings.}
\item{vars_accounted}{Matrix of explained variances and sums of squared
loadings. Based on the pooled unrotated loadings.}
\item{fit_indices}{For ML and ULS: Pooled fit indices derived from the unrotated
factor loadings: Chi Square, including significance level, degrees of freedom
(df), Comparative Fit Index (CFI), Root Mean Square Error of Approximation
(RMSEA), including its 90\% confidence interval, Akaike Information Criterion
(AIC), Bayesian Information Criterion (BIC), and the common part accounted
for (CAF) index as proposed by Lorenzo-Seva, Timmerman, & Kiers (2011).
For PAF, only the CAF and dfs are returned.}
\item{rot_loadings}{Loading matrix containing the final pooled rotated
loadings (pattern matrix).}
\item{Phi}{The pooled factor intercorrelations (only for oblique rotations).}
\item{Structure}{The pooled structure matrix (only for oblique rotations).}
\item{vars_accounted_rot}{Matrix of explained variances and sums of squared
loadings. Based on pooled rotated loadings and, for oblique rotations, the
pooled factor intercorrelations.}
\item{settings}{A list of the settings used.}
\item{ci_unrot_loadings}{CIs for the pooled unrotated loadings.}
\item{ci_rot_loadings}{CIs for the pooled rotated loadings.}
\item{ci_structure_loadings}{CIs for the pooled structure loadings (only for
oblique rotations).}
\item{ci_phis}{CIs for the pooled factor intercorrelations (only for oblique
rotations).}
\item{fits}{List of length \eqn{m} with the results from the \code{\link{EFA}}
runs for each imputed dataset.}
}
\description{
Consider a dataset with missing values that has been imputed \eqn{m} times.
This function runs \code{\link{EFA}} on each imputed dataset, averages the
estimated parameters (loadings) and calculates confidence intervals (CIs) on
the pooled (mean) loadings.
}
\details{
Multiple imputation (van Buuren, 2018) was developed by Rubin (1976). The
idea stems from the fact that that imputing one value (single imputation) for
the missing value could not be correct in general. Instead, impute the data
\eqn{m} times, i.e. generate multiple versions of the data table, where each
version has been imputed. Then, fit \eqn{m} models (e.g. \eqn{m} regressions
or \eqn{m} EFA models) and average (pool) the \eqn{m} estimated parameters
(e.g. the \eqn{m} regression coefficients of a given predictor or the \eqn{m}
loadings of a given variable and factor). This average is your estimate.

In \code{\link{EFA_POOLED}}, the pooled loading \eqn{\bar{\lambda_{ij}}}for
the \eqn{i}th variable and \eqn{j}th factor is calculated as
\eqn{\frac{1}{m}\sum_{k=1}^{m}{\lambda_{ij}^k}}, where \eqn{m} is the number
of imputations

Similarly, for the \eqn{i}th variable, the communality \code{h2} returned by
\code{\link{EFA_POOLED}} is calculated from the pooled loadings as
\eqn{\sum_{j=1}^{p}{\bar{\lambda_{ij}}^2}}, where \eqn{p} is the number of
factors.
}
\examples{
dataset <- psych::bfi[1:500, 1:25] # Create dataset
apply(dataset, 2, function(x) sum(is.na(x))) # Any NAs in the columns?

# Function to impute columns
impute_vector <- function(x, func = mean) {
  replace(
    x,
    is.na(x),
    func(x, na.rm = TRUE)
  )
}

# Impute data using mean
dataset_imp_mean <- apply(
  dataset,
  2,
  impute_vector,
  func = mean
)

# Impute data using mean
dataset_imp_median <- apply(
  dataset,
  2,
  impute_vector,
  func = median
)

# List of imputed datasets, one using the mean, the other using the median
data_list <- list(
  dataset_imp_mean,
  dataset_imp_median
)

# Run EFA on each imputed dataset, pool the results
efa_pooled <- EFA_POOLED(data_list, p = 0.05, n_factors = 3,
                         type = "EFAtools", method = "ML", rotation = "oblimin")

}
\author{
Andreas Soteriades
}
